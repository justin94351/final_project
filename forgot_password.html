<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="utf-8" />
        <title>Forgot Password</title>
        <link rel="stylesheet" href="style.css"/>
        <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    </head>
    <body>
        <div class="wrapper">
            <h1>Forgot Password</h1>
            <p class="helper-text">
                Enter your account (or email). If it exists, we’ll send a reset link.
            </p>
            <form id="forgot-form">
                <div class="input-box">
                    <input id="account" type="text" placeholder="Account / Email" required />
                    <i class='bx bx-envelope'></i>
                </div>
                <button type="submit" class="btn">Send reset link</button>
                <div class="login-link">
                    <p class="to-login">
                        Back to
                        <a href="login.html">Login</a>
                    </p>
                </div>
            </form>
        </div>
        <script>
            document.getElementById('forgot-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const account = document.getElementById('account').value.trim();

            if (!account) {
                alert('Account cannot be empty.');
                return;
            }

            try {
                const res = await fetch('/api/auth/forgot-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ account })
                });

                let data = {};
                try { data = await res.json(); } catch (_) {}

                if (res.ok) {
                // 安全做法：不告訴使用者帳號是否存在
                alert('If the account exists, a reset link has been sent.');
                // 可選：導回登入頁
                // location.href = 'login.html';
                } else {
                alert(data.message || 'Failed to send reset link');
                }
            } catch (err) {
                console.error(err);
                alert('Connection failed. Please check server.');
            }
            });
        </script>
    </body>
</html>
